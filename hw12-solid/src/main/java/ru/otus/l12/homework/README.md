# Эмулятор АТМ (Банкомата)

## Описание

Эмулятор банкомата, реализованный с соблюдением принципов SOLID и объектно-ориентированного программирования. Банкомат умеет принимать банкноты разных номиналов, выдавать запрошенную сумму минимальным количеством банкнот и показывать остаток денежных средств.

## Архитектура

### Основные компоненты

1. **Banknote** - интерфейс банкноты
2. **DefaultBanknote** - реализация банкноты
3. **BanknoteCell** - интерфейс ячейки для хранения банкнот одного номинала
4. **DefaultBanknoteCell** - реализация ячейки
5. **ATM** - интерфейс банкомата
6. **DefaultATM** - основная реализация банкомата
7. **WithdrawalStrategy** - интерфейс стратегии выдачи денег
8. **GreedyWithdrawalStrategy** - жадный алгоритм выдачи денег
9. **InsufficientFundsException** - исключение при недостатке средств

### Принципы SOLID

#### 1. Single Responsibility Principle (SRP)
- **Banknote** - отвечает только за представление банкноты
- **BanknoteCell** - отвечает только за хранение банкнот одного номинала
- **ATM** - отвечает только за основные операции банкомата
- **WithdrawalStrategy** - отвечает только за алгоритм выдачи денег

#### 2. Open/Closed Principle (OCP)
- Можно добавлять новые типы банкнот, наследуя от `Banknote`
- Можно добавлять новые стратегии выдачи, реализуя `WithdrawalStrategy`
- Можно добавлять новые типы ячеек, реализуя `BanknoteCell`
- Существующий код не изменяется при добавлении новой функциональности

#### 3. Liskov Substitution Principle (LSP)
- `DefaultATM` может быть заменен любой реализацией `ATM`
- `DefaultBanknote` может быть заменена любой реализацией `Banknote`
- `DefaultBanknoteCell` может быть заменена любой реализацией `BanknoteCell`
- `GreedyWithdrawalStrategy` может быть заменена любой реализацией `WithdrawalStrategy`

#### 4. Interface Segregation Principle (ISP)
- Интерфейсы содержат только необходимые методы
- Клиенты не зависят от методов, которые они не используют
- Интерфейсы разделены по функциональности

#### 5. Dependency Inversion Principle (DIP)
- `ATM` зависит от абстракции `WithdrawalStrategy`, а не от конкретной реализации
- `ATM` зависит от абстракции `BanknoteCell`, а не от конкретной реализации
- Высокоуровневые модули не зависят от низкоуровневых модулей

## Использование

### Создание банкомата
```java
ATM atm = new DefaultATM();
```

### Загрузка банкнот
```java
Map<Integer, Integer> banknotes = new HashMap<>();
banknotes.put(5000, 10);  // 10 банкнот по 5000
banknotes.put(1000, 50);  // 50 банкнот по 1000
banknotes.put(500, 100);  // 100 банкнот по 500

atm.acceptBanknotes(banknotes);
```

### Выдача денег
```java
try {
    Map<Integer, Integer> withdrawal = atm.withdrawAmount(1500);
    // withdrawal содержит номиналы и количества выданных банкнот
} catch (InsufficientFundsException e) {
    // Обработка ошибки недостатка средств
}
```

### Получение информации
```java
int totalAmount = atm.getTotalAmount();
Map<Integer, Integer> cellStatus = atm.getCellStatus();
```

## Запуск демонстрации

```bash
java ru.otus.l12.homework.ATMDemo
```

## Запуск тестов

```bash
./gradlew test
```

## Особенности реализации

1. **Жадный алгоритм выдачи** - выдача максимальными номиналами для минимизации количества банкнот
2. **Валидация данных** - проверка корректности входных параметров
3. **Обработка ошибок** - информативные исключения с деталями
4. **Расширяемость** - легко добавлять новые стратегии и типы банкнот
5. **Тестируемость** - все компоненты легко тестируются изолированно

## Примеры тестов

- Тесты основных операций банкомата
- Тесты соблюдения принципов SOLID
- Тесты обработки ошибок
- Тесты граничных случаев
